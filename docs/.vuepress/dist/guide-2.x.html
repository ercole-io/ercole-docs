<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Ercole + ercole-web + nginx common setup istructions | Ercole</title>
    <meta name="description" content="Proactive Software Asset Management">
    
    
    <link rel="preload" href="/assets/css/0.styles.c2a5f0d6.css" as="style"><link rel="preload" href="/assets/js/app.21561b35.js" as="script"><link rel="preload" href="/assets/js/6.f4499a36.js" as="script"><link rel="preload" href="/assets/js/3.6e75f971.js" as="script"><link rel="preload" href="/assets/js/11.250c2092.js" as="script"><link rel="prefetch" href="/assets/js/10.078aaa9a.js"><link rel="prefetch" href="/assets/js/12.1ec8026e.js"><link rel="prefetch" href="/assets/js/4.abebecdd.js"><link rel="prefetch" href="/assets/js/5.20f70b6e.js"><link rel="prefetch" href="/assets/js/7.934cad43.js"><link rel="prefetch" href="/assets/js/8.ed4c31b6.js"><link rel="prefetch" href="/assets/js/9.701d7451.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.5c103d31.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c2a5f0d6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/ercole.svg" alt="Ercole" class="logo"> <span class="site-name can-hide">Ercole</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/introduction.html" class="nav-link">Documentation</a></div><div class="nav-item"><a href="https://repository.ercole.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Download
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://demo.ercole.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Demo
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://www.sorint.it/ercole" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Professional support
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://gitter.im/ercole-io/community" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitter
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/ercole-io/ercole" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/introduction.html" class="nav-link">Documentation</a></div><div class="nav-item"><a href="https://repository.ercole.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Download
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://demo.ercole.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Demo
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://www.sorint.it/ercole" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Professional support
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://gitter.im/ercole-io/community" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitter
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/ercole-io/ercole" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/introduction.html" class="sidebar-link">Introduction</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/introduction.html#main-functionalities" class="sidebar-link">Main functionalities</a></li><li class="sidebar-sub-header"><a href="/introduction.html#next-features" class="sidebar-link">Next features</a></li></ul></li><li><a href="/guide-2.x.html" class="active sidebar-link">Getting Started Ercole 2.x</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide-2.x.html#ercole-ercole-web-nginx-common-setup-istructions" class="sidebar-link">Ercole + ercole-web + nginx common setup istructions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide-2.x.html#requirements" class="sidebar-link">Requirements</a></li><li class="sidebar-sub-header"><a href="/guide-2.x.html#minimal-default-required-network-firewall-rules" class="sidebar-link">Minimal default required network/firewall rules</a></li><li class="sidebar-sub-header"><a href="/guide-2.x.html#instructions" class="sidebar-link">Instructions</a></li></ul></li><li class="sidebar-sub-header"><a href="/guide-2.x.html#ercole" class="sidebar-link">Ercole</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide-2.x.html#requirements-2" class="sidebar-link">Requirements</a></li><li class="sidebar-sub-header"><a href="/guide-2.x.html#installation-guide" class="sidebar-link">Installation guide</a></li><li class="sidebar-sub-header"><a href="/guide-2.x.html#ercole-configuration" class="sidebar-link">Ercole configuration</a></li><li class="sidebar-sub-header"><a href="/guide-2.x.html#notes-about-the-internal-repository" class="sidebar-link">Notes about the internal repository</a></li><li class="sidebar-sub-header"><a href="/guide-2.x.html#main-ercole-usage" class="sidebar-link">(main) ercole usage</a></li><li class="sidebar-sub-header"><a href="/guide-2.x.html#various-howto-examples" class="sidebar-link">Various HOWTO/examples</a></li></ul></li><li class="sidebar-sub-header"><a href="/guide-2.x.html#ercole-web" class="sidebar-link">Ercole-web</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide-2.x.html#requirements-3" class="sidebar-link">Requirements</a></li><li class="sidebar-sub-header"><a href="/guide-2.x.html#installation-guide-2" class="sidebar-link">Installation guide</a></li><li class="sidebar-sub-header"><a href="/guide-2.x.html#configuration" class="sidebar-link">Configuration</a></li></ul></li><li class="sidebar-sub-header"><a href="/guide-2.x.html#ercole-agent-and-ercole-agent-perl" class="sidebar-link">Ercole-agent and ercole-agent-perl</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide-2.x.html#differences" class="sidebar-link">Differences</a></li></ul></li><li class="sidebar-sub-header"><a href="/guide-2.x.html#ercole-agent-go" class="sidebar-link">Ercole-agent (go)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide-2.x.html#rhelx-installation" class="sidebar-link">RHELx installation</a></li><li class="sidebar-sub-header"><a href="/guide-2.x.html#windows-installation" class="sidebar-link">Windows installation</a></li><li class="sidebar-sub-header"><a href="/guide-2.x.html#operating-system-level-differences" class="sidebar-link">Operating system level differences</a></li><li class="sidebar-sub-header"><a href="/guide-2.x.html#configuration-2" class="sidebar-link">Configuration</a></li><li class="sidebar-sub-header"><a href="/guide-2.x.html#virtualization-target" class="sidebar-link">Virtualization target</a></li><li class="sidebar-sub-header"><a href="/guide-2.x.html#oracle-database-target" class="sidebar-link">Oracle/Database target</a></li><li class="sidebar-sub-header"><a href="/guide-2.x.html#oracle-exadata-target" class="sidebar-link">Oracle/Exadata target</a></li><li class="sidebar-sub-header"><a href="/guide-2.x.html#microsoft-sqlserver-target" class="sidebar-link">Microsoft/SQLServer target</a></li></ul></li><li class="sidebar-sub-header"><a href="/guide-2.x.html#ercole-agent-perl" class="sidebar-link">Ercole-agent-perl</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide-2.x.html#solaris-installation" class="sidebar-link">Solaris installation</a></li><li class="sidebar-sub-header"><a href="/guide-2.x.html#aix-installation" class="sidebar-link">AIX installation</a></li><li class="sidebar-sub-header"><a href="/guide-2.x.html#hpux-installation" class="sidebar-link">HPUX installation</a></li><li class="sidebar-sub-header"><a href="/guide-2.x.html#configuration-3" class="sidebar-link">Configuration</a></li></ul></li></ul></li><li><a href="/guide-1.x.html" class="sidebar-link">Getting Started Ercole 1.x</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide-1.x.html#ercole-server-installation" class="sidebar-link">Ercole server installation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide-1.x.html#requirements" class="sidebar-link">Requirements</a></li><li class="sidebar-sub-header"><a href="/guide-1.x.html#installation" class="sidebar-link">Installation</a></li></ul></li><li class="sidebar-sub-header"><a href="/guide-1.x.html#ercole-agent-installation" class="sidebar-link">Ercole agent installation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide-1.x.html#operating-system-support" class="sidebar-link">Operating System support</a></li><li class="sidebar-sub-header"><a href="/guide-1.x.html#database-support" class="sidebar-link">Database support</a></li><li class="sidebar-sub-header"><a href="/guide-1.x.html#rhel-oel-centos-installation" class="sidebar-link">RHEL/OEL/CentOS Installation</a></li><li class="sidebar-sub-header"><a href="/guide-1.x.html#windows-installation" class="sidebar-link">Windows installation</a></li><li class="sidebar-sub-header"><a href="/guide-1.x.html#hp-ux-11-3-installation" class="sidebar-link">HP-UX 11.3 Installation</a></li><li class="sidebar-sub-header"><a href="/guide-1.x.html#aix-installation" class="sidebar-link">AIX Installation</a></li></ul></li><li class="sidebar-sub-header"><a href="/guide-1.x.html#ercole-agent-virtualization-installation" class="sidebar-link">Ercole agent virtualization installation</a></li><li class="sidebar-sub-header"><a href="/guide-1.x.html#ercole-agent-exadata-installation" class="sidebar-link">Ercole agent-exadata installation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide-1.x.html#operating-system-support-2" class="sidebar-link">Operating System support</a></li><li class="sidebar-sub-header"><a href="/guide-1.x.html#installation-7" class="sidebar-link">Installation</a></li></ul></li></ul></li><li><a href="/architecture.html" class="sidebar-link">Architecture</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/architecture.html#the-ercole-project" class="sidebar-link">The Ercole Project</a></li><li class="sidebar-sub-header"><a href="/architecture.html#data-format" class="sidebar-link">Data format</a></li><li class="sidebar-sub-header"><a href="/architecture.html#deployment" class="sidebar-link">Deployment</a></li><li class="sidebar-sub-header"><a href="/architecture.html#future-versions" class="sidebar-link">Future versions</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="ercole-ercole-web-nginx-common-setup-istructions"><a href="#ercole-ercole-web-nginx-common-setup-istructions" aria-hidden="true" class="header-anchor">#</a> Ercole + ercole-web + nginx common setup istructions</h2> <h3 id="requirements"><a href="#requirements" aria-hidden="true" class="header-anchor">#</a> Requirements</h3> <table><thead><tr><th style="text-align:center;">Component</th> <th>Prerequisite</th></tr></thead> <tbody><tr><td style="text-align:center;">Operating system</td> <td>CentOS, RedHat, OracleLinux 7/8</td></tr> <tr><td style="text-align:center;">RAM</td> <td>4GB</td></tr> <tr><td style="text-align:center;">Filesystem</td> <td>50GB (minimum)</td></tr> <tr><td style="text-align:center;">CPU</td> <td>2 VirtualCPU</td></tr> <tr><td style="text-align:center;">Database</td> <td><a href="https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/" target="_blank" rel="noopener noreferrer">MongoDB<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> &gt;= 4.2.0</td></tr></tbody></table> <h3 id="minimal-default-required-network-firewall-rules"><a href="#minimal-default-required-network-firewall-rules" aria-hidden="true" class="header-anchor">#</a> Minimal default required network/firewall rules</h3> <table><thead><tr><th style="text-align:center;">From</th> <th>To</th> <th>Port</th> <th>Proto</th></tr></thead> <tbody><tr><td style="text-align:center;">users</td> <td>nginx</td> <td>80</td> <td>HTTPS</td></tr> <tr><td style="text-align:center;">agents</td> <td>nginx</td> <td>80</td> <td>HTTPS</td></tr> <tr><td style="text-align:center;">users</td> <td>nginx</td> <td>443</td> <td>HTTPS</td></tr> <tr><td style="text-align:center;">agents</td> <td>nginx</td> <td>443</td> <td>HTTPS</td></tr></tbody></table> <p>It's highly recommended to also add <a href="#suggested-network-firewall-rules">network/firewall rules for downloading artifacts from github.com</a>.</p> <h3 id="instructions"><a href="#instructions" aria-hidden="true" class="header-anchor">#</a> Instructions</h3> <p>This installation guide is for RHEL8, but the steps can be easily adapted for RHEL7 .</p> <p>Add yum repositories with ercole RPMs</p> <ul><li><code>curl https://repository.ercole.io/shared/ercole-rhel8-x86_64.repo | tee /etc/yum.repos.d/ercole-x86_64.repo</code></li> <li><code>curl https://repository.ercole.io/shared/ercole-rhel8-noarch.repo | tee /etc/yum.repos.d/ercole-noarch.repo</code>
Install the required packages</li> <li><code>yum install ercole ercole-web nginx</code></li> <li>Configure nginx by overwriting the file <code>/etc/nginx/nginx.conf</code> to something like:</li></ul> <div class="language- extra-class"><pre class="language-text"><code># For more information on configuration, see:
#   * Official English Documentation: http://nginx.org/en/docs/
#   * Official Russian Documentation: http://nginx.org/ru/docs/

user nginx;
worker_processes auto;
error_log /var/log/nginx/error.log;
pid /run/nginx.pid;

# Load dynamic modules. See /usr/share/doc/nginx/README.dynamic.
include /usr/share/nginx/modules/*.conf;

events {
    worker_connections 1024;
}

http {
    log_format  main  '$remote_addr - $remote_user [$time_local] &quot;$request&quot; '
                      '$status $body_bytes_sent &quot;$http_referer&quot; '
                      '&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;';

    access_log  /var/log/nginx/access.log  main;

    sendfile            on;
    tcp_nopush          on;
    tcp_nodelay         on;
    keepalive_timeout   65;
    types_hash_max_size 2048;

    include             /etc/nginx/mime.types;
    default_type        application/octet-stream;

    # Load modular configuration files from the /etc/nginx/conf.d directory.
    # See http://nginx.org/en/docs/ngx_core_module.html#include
    # for more information.
    include /etc/nginx/conf.d/*.conf;

    server {
        listen       80 default_server;
        listen       [::]:80 default_server;
        server_name  _;
        root         /usr/share/ercole/web;

        # Load configuration files for the default server block.
        include /etc/nginx/default.d/*.conf;

        location / {
	        try_files $uri $uri/ /index.html =404;
        }

        location /data/ {
            proxy_pass http://127.0.0.1:11111/;
        }

        location /api/ {
            proxy_pass http://127.0.0.1:11113/;
        }

        location /repo/ {
            proxy_pass http://127.0.0.1:11114/;
        }

        location /chart/ {
            proxy_pass http://127.0.0.1:11116/;
        }
    }

    # Redirect http to https
    # server {
    #     listen 80 default_server;
    # 
    #     server_name _;
    # 
    #     return 301 https://$host$request_uri;
    # }

    # Settings for a TLS enabled server.
    #
    server {
        listen       443 ssl http2 default_server;
        listen       [::]:443 ssl http2 default_server;
        server_name  _;

        ssl_certificate &quot;/etc/pki/nginx/server.crt&quot;;
        ssl_certificate_key &quot;/etc/pki/nginx/private/server.key&quot;;
        ssl_session_cache shared:SSL:1m;
        ssl_session_timeout  10m;
        ssl_ciphers PROFILE=SYSTEM;
        ssl_prefer_server_ciphers on;

        root         /usr/share/ercole/web;

        # Load configuration files for the default server block.
        include /etc/nginx/default.d/*.conf;

        location / {
	        try_files $uri $uri/ /index.html =404;
        }

        location /data/ {
            proxy_pass http://127.0.0.1:11111/;
        }

        location /api/ {
            proxy_pass http://127.0.0.1:11113/;
        }

        location /repo/ {
            proxy_pass http://127.0.0.1:11114/;
        }

        location /chart/ {
            proxy_pass http://127.0.0.1:11116/;
        }
    }
}
</code></pre></div><ul><li><code>mkdir -p /etc/pki/nginx/private</code></li> <li><code>openssl req -nodes -x509 -newkey rsa:4096 -keyout /etc/pki/nginx/private/server.key -out /etc/pki/nginx/server.crt</code>.</li> <li>Add the following lines to /etc/ercole/conf.d/20-ercolesetup.toml:</li></ul> <div class="language- extra-class"><pre class="language-text"><code># FE.APIService.RemoteEndpoint = &quot;https://&lt;myip&gt;/api&quot;
# FE.ChartService.RemoteEndpoint = &quot;https://&lt;myip&gt;/chart&quot;
</code></pre></div><ul><li>If your machine has multiple IP addresses, check and fix endpoints in <code>/etc/ercole/conf.d/20-ercolesetup.toml</code>.</li> <li>If you want change the URI used to connect to mongodb, run the command <code>echo 'Mongodb.URI = &quot;mongodb://user:pass@ip:port/ercole&quot;' &gt; /etc/ercole/conf.d/40-mongoconf.toml</code> with the right <a href="https://docs.mongodb.com/manual/reference/connection-string/" target="_blank" rel="noopener noreferrer">Mongo URI<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</li> <li>Review ercole configuration with <code>ercole show-config</code></li> <li>If you have changed ercole configuration, run the command <code>ercole-setup</code></li> <li><code>systemctl start ercole</code></li> <li><code>systemctl start enable nginx</code></li> <li><code>systemctl start nginx</code></li></ul> <h4 id="troubleshooting"><a href="#troubleshooting" aria-hidden="true" class="header-anchor">#</a> Troubleshooting</h4> <h5 id="failed-13-permission-denied-while-connecting-to-upstream-in-var-log-nginx-error-log"><a href="#failed-13-permission-denied-while-connecting-to-upstream-in-var-log-nginx-error-log" aria-hidden="true" class="header-anchor">#</a> Failed (13: Permission denied) while connecting to upstream in /var/log/nginx/error.log</h5> <p>If curl https://127.0.0.1/repo/ping.txt doesn't return PONG! but returns nginx's 404 page and <code>/var/log/nginx/error.log</code> contains lines like</p> <div class="language- extra-class"><pre class="language-text"><code>2020/08/03 09:25:01 [crit] 77642#0: *16 connect() to 127.0.0.1:11111 failed (13: Permission denied) while connecting to upstream, client: 127.0.0.1, server: _, request: &quot;GET /data/ping HTTP/1.1&quot;, upstream: &quot;http://127.0.0.1:11111/ping&quot;, host: &quot;127.0.0.1&quot;
</code></pre></div><p>Execute the command <code>setsebool -P httpd_can_network_connect 1</code>.
<a href="https://stackoverflow.com/questions/23948527/13-permission-denied-while-connecting-to-upstreamnginx" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/23948527/13-permission-denied-while-connecting-to-upstreamnginx<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="ercole"><a href="#ercole" aria-hidden="true" class="header-anchor">#</a> Ercole</h2> <p>Ercole is the backend component of ercole.io project.</p> <h3 id="requirements-2"><a href="#requirements-2" aria-hidden="true" class="header-anchor">#</a> Requirements</h3> <table><thead><tr><th style="text-align:center;">Component</th> <th>Prerequisite</th></tr></thead> <tbody><tr><td style="text-align:center;">Operating system</td> <td>CentOS, RedHat, OracleLinux 7/8</td></tr> <tr><td style="text-align:center;">RAM</td> <td>4GB</td></tr> <tr><td style="text-align:center;">Filesystem</td> <td>50GB (minimum)</td></tr> <tr><td style="text-align:center;">CPU</td> <td>2 VirtualCPU</td></tr> <tr><td style="text-align:center;">Database</td> <td>MongoDB &gt;= 4.2.0</td></tr></tbody></table> <h4 id="minimal-default-required-network-firewall-rules-2"><a href="#minimal-default-required-network-firewall-rules-2" aria-hidden="true" class="header-anchor">#</a> Minimal default required network/firewall rules</h4> <table><thead><tr><th style="text-align:center;">From</th> <th>To</th> <th>Port</th> <th>Proto</th></tr></thead> <tbody><tr><td style="text-align:center;">agents</td> <td>ercole-dataservice</td> <td>11111</td> <td>HTTP[1]</td></tr> <tr><td style="text-align:center;">users</td> <td>ercole-apiservice</td> <td>11113</td> <td>HTTP[1]</td></tr> <tr><td style="text-align:center;">users</td> <td>ercole-chartservice</td> <td>11116</td> <td>HTTP[1]</td></tr> <tr><td style="text-align:center;">users</td> <td>ercole-reposervice</td> <td>11114</td> <td>HTTP[1]</td></tr> <tr><td style="text-align:center;">agents</td> <td>ercole-reposervice</td> <td>11114</td> <td>HTTP[1]</td></tr> <tr><td style="text-align:center;">users</td> <td>ercole-reposervice</td> <td>11115</td> <td>SSH</td></tr> <tr><td style="text-align:center;">agents</td> <td>ercole-reposervice</td> <td>11115</td> <td>SSH</td></tr></tbody></table> <p>[1] It is highly recommended to setup a reverse proxy between users/agents and ercole for avoiding to comunicate directly to the microservices using HTTP and opening too much ports, using for example nginx. See the istructions below.</p> <h5 id="suggested-network-firewall-rules"><a href="#suggested-network-firewall-rules" aria-hidden="true" class="header-anchor">#</a> Suggested network/firewall rules</h5> <table><thead><tr><th style="text-align:center;">From</th> <th>To</th> <th>Port</th> <th>Proto</th></tr></thead> <tbody><tr><td style="text-align:center;">ercole-reposervice</td> <td>*.github.com</td> <td>443</td> <td>HTTPS[1]</td></tr> <tr><td style="text-align:center;">ercole-reposervice</td> <td>repository.ercole.io</td> <td>443</td> <td>HTTPS[1]</td></tr></tbody></table> <p>[1] You can safely separate ercole-reposervice from the others microservices.</p> <h3 id="installation-guide"><a href="#installation-guide" aria-hidden="true" class="header-anchor">#</a> Installation guide</h3> <p>This installation guide is for RHEL8, but the steps can be easily adapted for RHEL7 .</p> <ul><li><code>curl https://repository.ercole.io/shared/ercole-rhel8-x86_64.repo | tee /etc/yum.repos.d/ercole-x86_64.repo</code></li> <li><code>yum install ercole</code></li> <li>If your machine has multiple IP addresses, check and fix endpoints in <code>/etc/ercole/conf.d/20-ercolesetup.toml</code></li> <li>Review ercole configuration with <code>ercole show-config</code></li> <li><code>systemctl start ercole</code></li></ul> <p>Ercole is configured automatically during the installation but you can edit the configuration by creating/files in <code>/etc/ercole/conf.d</code>. Its logs can be read with the command <code>journalctl -u ercole-dataservice -u ercole-alertservice -u ercole-apiservice -u ercole-reposervice -u ercole-chartservice</code> and can be updated as usually with a simple <code>yum update</code> unless in the new versions were introduced breaking changes.
It is also recommeded to also install <a href="https://stedolan.github.io/jq/download/" target="_blank" rel="noopener noreferrer">jq<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.
After the installation you may want to <a href="#installation-guide-2">install ercole-web and configure nginx</a> or to <a href="#various-howto-examples">install artifacts</a>.</p> <h3 id="ercole-configuration"><a href="#ercole-configuration" aria-hidden="true" class="header-anchor">#</a> Ercole configuration</h3> <p>The configuration is written in <a href="https://github.com/toml-lang/toml" target="_blank" rel="noopener noreferrer">TOML<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> syntax and it is stored in these files/directory in ascending order of priority. The properties specified in low priority configuration files are overriden by the values in high priority configuration files. The configurations files are:</p> <ul><li><code>/opt/ercole/config.toml</code> (legacy config file)</li> <li><code>/usr/share/ercole/config.toml</code> (distributor config file)</li> <li><code>/etc/ercole/ercole.toml</code></li> <li><code>/etc/ercole/conf.d/*.toml</code> <ul><li><code>/etc/ercole/conf.d/20-ercolesetup.toml</code> is a file created by <code>ercole-setup</code> utility that contains known host specific configuration like remote endpoints, paths to certificates/keys and inter microservice configuration params.</li></ul></li> <li><code>~/.config/ercole.toml</code></li> <li><code>./config.toml</code></li> <li>An optional file specified to the <code>ercole</code> using the <code>-c</code> option.</li></ul> <p>It's highly recommended to configure it by creating files in <code>/etc/ercole/conf.d</code> (e.g <code>/etc/ercole/conf.d/50-myconf.toml</code>). If you change the <code>RemoteEndpoint</code>s of the microservices you may need to re-run <code>ercole-setup</code>(or <code>ercoleweb-setup</code> if you have installed ercole-web).</p> <h4 id="main-configuration-properties-list"><a href="#main-configuration-properties-list" aria-hidden="true" class="header-anchor">#</a> (main) Configuration properties list</h4> <h5 id="mongodb"><a href="#mongodb" aria-hidden="true" class="header-anchor">#</a> Mongodb.*</h5> <ul><li><code>Mongodb.URI</code> is the <a href="https://docs.mongodb.com/manual/reference/connection-string/" target="_blank" rel="noopener noreferrer">uri<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> used to connect to the mongodb database. The default value is <code>mongodb://localhost:27017/ercole</code>.</li> <li><code>Mongodb.DBName</code> is the name of the mongodb database. The default value is <code>ercole</code>.</li> <li><code>Mongodb.Migrate</code> contains true if ercole should update/migrate the database schema, otherwise false. The default value is <code>true</code>. When ercole is started, it try to update the structure of the database by updating the schemas, updating the documents, creating the indexes, inserting default values.</li></ul> <h5 id="dataservice"><a href="#dataservice" aria-hidden="true" class="header-anchor">#</a> DataService.*</h5> <ul><li><code>DataService.RemoteEndpoint</code> contains the URI used by clients to connect to the dataservice.</li> <li><code>DataService.BindIP</code> contains the IP Address on which data service listen.</li> <li><code>DataService.Port</code> contains the port on which data service listen.</li> <li><code>DataService.LogHTTPRequest</code> enable the logging of the http request.</li> <li><code>DataService.LogInsertingHostdata</code> enable the logging of the inserting hostdata.</li> <li><code>DataService.LogDataPatching</code> enable the logging of data patching events.</li> <li><code>DataService.EnablePatching</code> enable the patching of hostdata. It's required for tagging the hosts and modifying Oracle Database license count values.</li> <li><code>DataService.AgentUsername</code> contains the username used to authenticate agents</li> <li><code>DataService.AgentPassword</code> contains the password used to authenticate agents</li> <li><code>DataService.CurrentHostCleaningJob.Crontab</code> contains the <a href="https://en.wikipedia.org/wiki/Cron" target="_blank" rel="noopener noreferrer">cron<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> schedule expression for automatic archivial of the current (non archived).</li> <li><code>DataService.CurrentHostCleaningJob.HourThreshold</code> contains the maximium number of hours in which a hostdata is considered up to date. After this threshold the host will be archived by the CurrentHostCleaningJob.</li> <li><code>DataService.CurrentHostCleaningJob.RunAtStartup</code> enable the running of the current host cleaning job at startup.</li> <li><code>DataService.ArchivedHostCleaningJob.Crontab</code> contains the <a href="https://en.wikipedia.org/wiki/Cron" target="_blank" rel="noopener noreferrer">cron<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> schedule expression for automatic deletion of archived hosts.</li> <li><code>DataService.ArchivedHostCleaningJob.HourThreshold</code> contains the maximium number of hours in which a archived hostdata is retained. After this threshold the archived host will be deleted by the ArchivedHostCleaningJob.</li> <li><code>DataService.ArchivedHostCleaningJob.RunAtStartup</code> enable the running of the archived host cleaning job at startup.</li></ul> <h5 id="alertservice"><a href="#alertservice" aria-hidden="true" class="header-anchor">#</a> AlertService.*</h5> <ul><li><code>AlertService.RemoteEndpoint</code> contains the URI used by the microservices to connect to the alertservice.</li> <li><code>AlertService.BindIP</code> contains the IP Address on which alert service listen.</li> <li><code>AlertService.Port</code> contains the port on which alert service listen.</li> <li><code>AlertService.LogHTTPRequest</code> enable the logging of the http request.</li> <li><code>AlertService.LogMessages</code> enable the logging of the processing queue messages.</li> <li><code>AlertService.LogAlertThrows</code> enable the logging of throwing alerts.</li> <li><code>AlertService.PublisherUsername</code> contains the username used to authenticate the microservices.</li> <li><code>AlertService.PublisherPassword</code> contains the password used to authenticate the microservices.</li> <li><code>AlertService.FreshnessCheckJob.Crontab</code> contains the <a href="https://en.wikipedia.org/wiki/Cron" target="_blank" rel="noopener noreferrer">cron<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> schedule expression for automatic throws of NO_DATA alerts when a current host is not up to date.</li> <li><code>AlertService.FreshnessCheckJob.HourThreshold</code> contains the maximium number of hours in which a hostdata is considered up to date. After this threshold a NO_DATA alert is thrown by the FreshnessCheckJob.</li> <li><code>AlertService.FreshnessCheckJob.RunAtStartup</code> enable the running of the freshness check job at startup.</li> <li><code>AlertService.Emailer.Enabled</code> enable the notifying of the alerts by email.</li> <li><code>AlertService.Emailer.From</code> the source email address that is used to send emails.</li> <li><code>AlertService.Emailer.To</code> the destination email addresses to which are sent the emails.</li> <li><code>AlertService.Emailer.SMTPServer</code> SMTP server used to send email.</li> <li><code>AlertService.Emailer.SMTPPort</code> port of the SMTP server used to send email.</li> <li><code>AlertService.Emailer.SMTPUsername</code> username used to authenticate to the SMTP server.</li> <li><code>AlertService.Emailer.SMTPPassword</code> password used to authenticate to the SMTP server.</li> <li><code>AlertService.Emailer.DisableSSLCertificateValidation</code> true if disable the authentication of the SMTP server.</li></ul> <h5 id="apiservice"><a href="#apiservice" aria-hidden="true" class="header-anchor">#</a> APIService.*</h5> <ul><li><code>APIService.RemoteEndpoint</code> contains the URI used by the clients to connect to the apiservice.</li> <li><code>APIService.BindIP</code> contains the IP Address on which api service listen.</li> <li><code>APIService.Port</code> contains the port on which api service listen.</li> <li><code>APIService.LogHTTPRequest</code> enable the logging of the http request.</li> <li><code>APIService.ReadOnly</code> disable the APIs that modify the data</li> <li><code>APIService.EnableInsertingCustomPatchingFunction</code> enable the possibility to add/set a custom patching function.</li> <li><code>APIService.DebugOracleDatabaseAgreementsAssignmentAlgorithm</code> enable the verbosity of the assignment algorithm used to distribuite oracle database agreement licenses.</li> <li><code>APIService.AuthenticationProvider.Type</code> contains the authentication type. The allowed values are <code>basic</code> and <code>ldap</code>.</li> <li><code>APIService.AuthenticationProvider.Username</code> contains the username used to authenticate user when <code>Type</code> is <code>basic</code>. It also contains the username used by <code>ercole</code> to perform requests to APIService.</li> <li><code>APIService.AuthenticationProvider.Password</code> contains the password used to authenticate password when <code>Type</code> is <code>basic</code>. It also contains the password used by <code>ercole</code> to perform requests to APIService.</li> <li><code>APIService.AuthenticationProvider.Username</code> contains the username used to authenticate user when <code>Type</code> is <code>basic</code>. It also contains the username used by <code>ercole</code> to perform requests to APIService.</li> <li><code>APIService.AuthenticationProvider.Password</code> contains the password used to authenticate password when <code>Type</code> is <code>basic</code>. It also contains the password used by <code>ercole</code> to perform requests to APIService.</li> <li><code>APIService.AuthenticationProvider.PrivateKey</code> contains the key used to sign the authentication JWT tokens.</li> <li><code>APIService.AuthenticationProvider.PublicKey</code> contains the key used to validate the authentication JWT tokens.</li> <li><code>APIService.AuthenticationProvider.TokenValidityTimeout</code> contains the maximum number of seconds on which the token is considered valid.</li> <li><code>APIService.AuthenticationProvider.Host</code>, when <code>Type</code> is <code>ldap</code>, contains the server used to authenticate the users.</li> <li><code>APIService.AuthenticationProvider.Port</code>, when <code>Type</code> is <code>ldap</code>, contains the port used to connect to the LDAP server. e.g. 389.</li> <li><code>APIService.AuthenticationProvider.LDAPBase</code>, when <code>Type</code> is <code>ldap</code>, contains the LDAP base of the realm. e.g. dc=planetexpress,dc=com.</li> <li><code>APIService.AuthenticationProvider.LDAPUseSSL</code>, when <code>Type</code> is <code>ldap</code>, enable/disable SSL for connecting to the server.</li> <li><code>APIService.AuthenticationProvider.LDAPBindDN</code>, when <code>Type</code> is <code>ldap</code>, contains the account used to authenticate to the LDAP server. e.g. cn=admin,dc=planetexpress,dc=com.</li> <li><code>APIService.AuthenticationProvider.LDAPBindPassword</code>, when <code>Type</code> is <code>ldap</code>, contains the password account used to authenticate to the LDAP server. e.g. GoodNewsEveryone.</li> <li><code>APIService.AuthenticationProvider.LDAPUserFilter</code>, when <code>Type</code> is <code>ldap</code>, it's unknown the purpose of this field but put <code>(uid=%s)</code>.</li> <li><code>APIService.AuthenticationProvider.LDAPGroupFilter</code>, when <code>Type</code> is <code>ldap</code>, it's unknown the purpose of this field but put <code>(memberUid=%s)</code>.</li> <li><code>APIService.OperatingSystemAggregationRules</code> are the rules used to map OS names + Version to product.</li></ul> <h5 id="reposervice"><a href="#reposervice" aria-hidden="true" class="header-anchor">#</a> RepoService.*</h5> <ul><li><code>RepoService.UpstreamRepositories</code> contains the upstream repository from which the artifacts are downloaded.
<ul><li><code>Name</code> contains the name of the repository.</li> <li><code>Type</code> contains the type of the repository. The allowed values are <code>github-release</code>, <code>directory</code>, <code>ercole-reposervice</code>.</li> <li><code>URL</code> contains the URL used to find the files. In the case of <code>github-release</code> it should the URL of the API that return the releases list. e.g https://api.github.com/repos/ercole-io/ercole-agent/releases. In the case of <code>directory</code> it should be the directory in which the artifacts are contained. In the case of <code>ercole-reposervice</code> it should be the url of a directory that contains the directory <code>all</code> and the file <code>index.json</code>.</li></ul></li> <li><code>RepoService.HTTP.Enable</code> contains true if reposervice should serve the files via HTTP.</li> <li><code>RepoService.HTTP.RemoteEndpoint</code> contains the url used by clients to reach the repository via HTTP.</li> <li><code>RepoService.HTTP.BindIP</code> contains the IP on which reposervice listen for HTTP requests.</li> <li><code>RepoService.HTTP.Port</code> contains the port on which reposervice listen for HTTP requests.</li> <li><code>RepoService.HTTP.LogHTTPRequest</code> true if reposervice should log for every received HTTP request.</li> <li><code>RepoService.SFTP.Enable</code> contains true if reposervice should serve the files via SFTP.</li> <li><code>RepoService.SFTP.RemoteEndpoint</code> contains the url used by clients to reach the repository via SFTP.</li> <li><code>RepoService.SFTP.BindIP</code> contains the IP on which reposervice listen for SFTP.</li> <li><code>RepoService.SFTP.Port</code> contains the port on which reposervice listen for SFTP.</li> <li><code>RepoService.SFTP.PrivateKey</code> contains the private key used by the SFTP server.</li> <li><code>RepoService.SFTP.LogConnections</code> true if reposervice should log the connections from SFTP clients.</li> <li><code>RepoService.SFTP.DebugConnections</code> true if reposervice should log degug messages of the connections from SFTP clients.</li></ul> <h5 id="chartservice"><a href="#chartservice" aria-hidden="true" class="header-anchor">#</a> ChartService.*</h5> <ul><li><code>ChartService.RemoteEndpoint</code> contains the URI used by the clients to connect to the chartservice.</li> <li><code>ChartService.BindIP</code> contains the IP Address on which chart service listen.</li> <li><code>ChartService.Port</code> contains the port on which chart service listen.</li> <li><code>ChartService.LogHTTPRequest</code> enable the logging of the http request.</li></ul> <h3 id="notes-about-the-internal-repository"><a href="#notes-about-the-internal-repository" aria-hidden="true" class="header-anchor">#</a> Notes about the internal repository</h3> <p>Ercole repository is tought to be public and visibile to everyone so it shouldn't contains private informations like the password or private keys. The main ercole repository is <a href="https://repository.ercole.io" target="_blank" rel="noopener noreferrer">https://repository.ercole.io<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. It is served via HTTP and via SFTP so you can download files in various mode like:</p> <ul><li><code>wget http://myawesomeercole2.local:11114/ping.txt</code></li> <li><code>curl http://myawesomeercole2.local:11114/ping.txt &gt; /tmp/ping.txt</code></li> <li><code>sftp -P 11115 myawesomeercole2.local/ping.txt /tmp/ping.txt</code>
Some repository files/directory are managed using the <code>ercole repo</code> subcommands. Others files/directories can be safely modified.</li></ul> <p>Managed files:
* <code>ping.txt</code> is a file used to check the liveness of the microservices. It's really managed but it's recommended to not modify it.
* <code>index.json</code> contains the cached list of available artifacts. Can be safely removed for forcing the rebuild of the cache when the next <code>repo</code> subcommands is run.
* <code>all/</code> contains the symlinks to all installed (and managed) artifacts.
* <code>rhel/*</code> contains the RPM repositories of the packages for every RHEL versions.
* <code>win/*</code> contains various ercole-agent setup files for windows.
* <code>aix/</code> contains the RPM repositories of the packages for every AIX versions.
* <code>aix-tar-gz/</code> alternative artifacts of agents for AIX.
* <code>hpux/</code> contains the agents for HPUX.</p> <p>Unmanaged known files:
* <code>shared/</code> contains various files like some .repo files.
* <code>snapshots/</code> is a directory present in <a href="https://repository.ercole.io" target="_blank" rel="noopener noreferrer">https://repository.ercole.io<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> that is used to store snapshots of all projects. The snapshots aren't tought to be used outside the development.</p> <p>The public repository don't serve files via SFTP.
It may be a good idea to create multiple ercole reposervice for directory for stable/testing/unstable or PRD/COL/TST.</p> <h3 id="main-ercole-usage"><a href="#main-ercole-usage" aria-hidden="true" class="header-anchor">#</a> (main) ercole usage</h3> <p>Ercole is a command line tool so it can be used to perform some.</p> <ul><li><code>ercole version</code> print the version of ecole.</li> <li><code>ercole show-config</code> show the ercole's actual configuration.</li> <li><code>ercole fire-hostdata</code> send a hostdata stored in a json file or from a stdin to ercole-dataservice.</li> <li><code>ercole migrate</code> migrate the structure of the mongodb database from a previous one to the latest.</li> <li><code>ercole serve</code> start the services. Every microservices can be turned on/off esplicitily using the various --enable options like --enable-dataservice.</li> <li><code>ercole api</code> is a group of subcommands used to perform request data from ercole-apiservice.</li> <li><code>ercole chart</code> is a group of subcommands used to perform request data from ercole-chartservice.</li> <li><code>ercole repo</code> is a group of subcommands used to manage the repository. Can accept the command --rebuild-cache to force the rebuild of the cache stored in <code>/var/lib/ercole/distributed_directory/index.json</code>.
<ul><li><code>... list</code> lists the artifacts detected in the upstream repositories.</li> <li><code>... info</code> get the informations about the specified artifacts.</li> <li><code>... install</code> download and install the specified artifacts.</li> <li><code>... remove</code> uninstall the specified artifacts.</li> <li><code>... update</code> try to find newer version of all installed artifacts and install them.</li></ul></li></ul> <h3 id="various-howto-examples"><a href="#various-howto-examples" aria-hidden="true" class="header-anchor">#</a> Various HOWTO/examples</h3> <h4 id="how-to-install-a-artifact"><a href="#how-to-install-a-artifact" aria-hidden="true" class="header-anchor">#</a> How to install a artifact</h4> <ul><li>The first thing to do is to find the available artifacts by running the command: <code>ercole repo list</code></li> <li>Choose the artifact you want.</li> <li>Install it with for example with the command: <code>ercole repo install ercole-agent/ercole-agent-rhel7@1.5.0</code></li></ul> <h4 id="install-a-package-to-rhelx-from-the-ercole-reposervice"><a href="#install-a-package-to-rhelx-from-the-ercole-reposervice" aria-hidden="true" class="header-anchor">#</a> Install a package to rhelX from the ercole-reposervice</h4> <p>The first thing to do is to create a repository file .</p> <ul><li><code>curl https://repository.ercole.io/shared/ercole-rhel7-x86_64.repo | tee /etc/yum.repos.d/ercole.repo</code></li></ul> <p>The next thing is to install the package with yum or dnf.</p> <ul><li><code>yum install ercole-agent</code></li></ul> <h2 id="ercole-web"><a href="#ercole-web" aria-hidden="true" class="header-anchor">#</a> Ercole-web</h2> <p>Ercole-web is the official optional frontend of the ercole.io project</p> <h3 id="requirements-3"><a href="#requirements-3" aria-hidden="true" class="header-anchor">#</a> Requirements</h3> <table><thead><tr><th style="text-align:center;">Component</th> <th>Prerequisite</th></tr></thead> <tbody><tr><td style="text-align:center;">Operating system</td> <td>CentOS, RedHat, OracleLinux 7/8</td></tr> <tr><td style="text-align:center;">RAM</td> <td>512MB</td></tr> <tr><td style="text-align:center;">Filesystem</td> <td>2GB (minimum)</td></tr> <tr><td style="text-align:center;">CPU</td> <td>1 VirtualCPU</td></tr></tbody></table> <h3 id="installation-guide-2"><a href="#installation-guide-2" aria-hidden="true" class="header-anchor">#</a> Installation guide</h3> <p>This installation guide is for RHEL8, but the steps can be easily adapted for RHEL7.</p> <ul><li><code>curl https://repository.ercole.io/shared/ercole-rhel8-noarch.repo | tee /etc/yum.repos.d/ercole-noarch.repo</code></li> <li><code>yum install ercole-web</code>
The website files can be found under <code>/usr/share/ercole/web/</code>.
If you want setup nginx for serving the files and proxy-pass you can follow this <a href="#how-to-setup-ercole-ercole-web-with-nginx-and-proxypass">HOWTO</a>.</li></ul> <h3 id="configuration"><a href="#configuration" aria-hidden="true" class="header-anchor">#</a> Configuration</h3> <p>Ercole-web has a single file and it's stored in <code>/usr/share/ercole/web/config.json</code>. The file isn't tought to be modified by hand but it's generated by <code>ercoleweb-setup</code> util using the values inside the file <code>/etc/ercole/conf.d/20-ercolesetup.toml</code>.</p> <h2 id="ercole-agent-and-ercole-agent-perl"><a href="#ercole-agent-and-ercole-agent-perl" aria-hidden="true" class="header-anchor">#</a> Ercole-agent and ercole-agent-perl</h2> <p>Ercole-agent and ercole-agent-perl are the data collectors that fetches some informations from various sources like the host and the software. Organize them in a JSON structure called hostdata and send them to the dataservice.</p> <h3 id="differences"><a href="#differences" aria-hidden="true" class="header-anchor">#</a> Differences</h3> <p>There are two different variant of ercole-agent: ercole-agent (go) and ercole-agent-perl. Their main differences are the programming language, operating system support and feature/targets support. It's advised to stick to ercole-agent (go)</p> <table><thead><tr><th style="text-align:left;">Feature</th> <th style="text-align:left;">Ercole-agent (go)</th> <th style="text-align:left;">Ercole-agent-perl</th></tr></thead> <tbody><tr><td style="text-align:left;">Programming Language</td> <td style="text-align:left;">Go 1.14</td> <td style="text-align:left;">Perl 5.8.8</td></tr> <tr><td style="text-align:left;">Linux (generic) support</td> <td style="text-align:left;">yes[1]</td> <td style="text-align:left;">no</td></tr> <tr><td style="text-align:left;">Windows Server &gt;= 2008R2 support</td> <td style="text-align:left;">yes</td> <td style="text-align:left;">no</td></tr> <tr><td style="text-align:left;">Solaris operating system support</td> <td style="text-align:left;">no</td> <td style="text-align:left;">yes[2]</td></tr> <tr><td style="text-align:left;">AIX operating system support</td> <td style="text-align:left;">no</td> <td style="text-align:left;">yes</td></tr> <tr><td style="text-align:left;">HP-UX operating system support</td> <td style="text-align:left;">no</td> <td style="text-align:left;">yes[2]</td></tr> <tr><td style="text-align:left;">Virtualization</td> <td style="text-align:left;">yes</td> <td style="text-align:left;">no</td></tr> <tr><td style="text-align:left;">(virtualization) Oracle/VM target</td> <td style="text-align:left;">yes</td> <td style="text-align:left;">no</td></tr> <tr><td style="text-align:left;">(virtualization) VMWare/VMWare target</td> <td style="text-align:left;">yes</td> <td style="text-align:left;">no</td></tr> <tr><td style="text-align:left;">Oracle/Database target</td> <td style="text-align:left;">yes</td> <td style="text-align:left;">yes</td></tr> <tr><td style="text-align:left;">Oracle/Exadata target</td> <td style="text-align:left;">yes</td> <td style="text-align:left;">no</td></tr> <tr><td style="text-align:left;">Microsoft/SQLServer target</td> <td style="text-align:left;">yes</td> <td style="text-align:left;">no</td></tr> <tr><td style="text-align:left;">MariaDBFoundation/MariaDB target</td> <td style="text-align:left;">no</td> <td style="text-align:left;">no</td></tr> <tr><td style="text-align:left;">PostgreSQL/PostgreSQL target</td> <td style="text-align:left;">no</td> <td style="text-align:left;">no</td></tr> <tr><td style="text-align:left;">Oracle/MySQL target</td> <td style="text-align:left;">no</td> <td style="text-align:left;">no</td></tr></tbody></table> <p>[1] It's packaged only for RHEL5, RHEL6, RHEL7, RHEL8.</p> <p>[2] It isn't already properly packaged.</p> <h2 id="ercole-agent-go"><a href="#ercole-agent-go" aria-hidden="true" class="header-anchor">#</a> Ercole-agent (go)</h2> <h3 id="rhelx-installation"><a href="#rhelx-installation" aria-hidden="true" class="header-anchor">#</a> RHELx installation</h3> <p>The installations instructions are written for RHEL8, but they are also applicable to older RHEL versions.</p> <ol><li><code>curl https://repository.ercole.io/shared/ercole-rhel8-x86_64.repo | tee /etc/yum.repos.d/ercole-x86_64.repo</code></li> <li><code>yum install ercole-agent</code></li></ol> <h3 id="windows-installation"><a href="#windows-installation" aria-hidden="true" class="header-anchor">#</a> Windows installation</h3> <p>On windows it's required to have powershell &gt;= 2.</p> <ol><li>Download the correct file from <a href="https://repository.ercole.io/win/win/x86_64/" target="_blank" rel="noopener noreferrer">https://repository.ercole.io/win/win/x86_64/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</li> <li>Click to the setup and follow the installation wizard. At the moment the customization of installation directory doesn't work correctly: it must be installed in <code>C:\ErcoleAgent</code> (see <a href="https://github.com/ercole-io/ercole-agent/issues/186" target="_blank" rel="noopener noreferrer">issue #186<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and <a href="https://github.com/ercole-io/ercole-agent/issues/54" target="_blank" rel="noopener noreferrer">issue #54<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>).</li></ol> <h3 id="operating-system-level-differences"><a href="#operating-system-level-differences" aria-hidden="true" class="header-anchor">#</a> Operating system level differences</h3> <table><thead><tr><th style="text-align:left;"></th> <th style="text-align:left;">RHEL5</th> <th style="text-align:left;">RHEL6</th> <th style="text-align:left;">RHEL7</th> <th style="text-align:left;">RHEL8</th> <th style="text-align:left;">Windows</th></tr></thead> <tbody><tr><td style="text-align:left;">Service handling program</td> <td style="text-align:left;">service</td> <td style="text-align:left;">systemctl</td> <td style="text-align:left;">systemctl</td> <td style="text-align:left;">systemctl</td> <td style="text-align:left;">services.msc</td></tr> <tr><td style="text-align:left;">Fetcher alternative user support</td> <td style="text-align:left;">Yes</td> <td style="text-align:left;">Yes</td> <td style="text-align:left;">Yes</td> <td style="text-align:left;">Yes</td> <td style="text-align:left;">No</td></tr> <tr><td style="text-align:left;">Powershell required</td> <td style="text-align:left;">No[1]</td> <td style="text-align:left;">No[1]</td> <td style="text-align:left;">No[1]</td> <td style="text-align:left;">No[1]</td> <td style="text-align:left;">Yes</td></tr> <tr><td style="text-align:left;"><code>Features.OracleDatabase.Oratab</code> used</td> <td style="text-align:left;">Yes</td> <td style="text-align:left;">Yes</td> <td style="text-align:left;">Yes</td> <td style="text-align:left;">Yes</td> <td style="text-align:left;">No</td></tr> <tr><td style="text-align:left;"><code>ForcePwshVersion</code> property used</td> <td style="text-align:left;">No</td> <td style="text-align:left;">No</td> <td style="text-align:left;">No</td> <td style="text-align:left;">No</td> <td style="text-align:left;">Yes</td></tr> <tr><td style="text-align:left;">Virtualization support</td> <td style="text-align:left;">Yes</td> <td style="text-align:left;">Yes</td> <td style="text-align:left;">Yes</td> <td style="text-align:left;">Yes</td> <td style="text-align:left;">No</td></tr> <tr><td style="text-align:left;">Oracle/Database support</td> <td style="text-align:left;">Yes</td> <td style="text-align:left;">Yes</td> <td style="text-align:left;">Yes</td> <td style="text-align:left;">Yes</td> <td style="text-align:left;">Yes</td></tr> <tr><td style="text-align:left;">Oracle/Exadata support</td> <td style="text-align:left;">Yes</td> <td style="text-align:left;">Yes</td> <td style="text-align:left;">Yes</td> <td style="text-align:left;">Yes</td> <td style="text-align:left;">No</td></tr> <tr><td style="text-align:left;">Microsoft/SQLServer support</td> <td style="text-align:left;">No</td> <td style="text-align:left;">No</td> <td style="text-align:left;">No</td> <td style="text-align:left;">No</td> <td style="text-align:left;">Yes</td></tr></tbody></table> <p>[1] Except when Virtualization feature is enabled</p> <h3 id="configuration-2"><a href="#configuration-2" aria-hidden="true" class="header-anchor">#</a> Configuration</h3> <p>Ercole-agent can be configured modifying the content of the <code>config.json</code> stored in <code>/opt/ercole-agent/config.json</code> (Linux) or <code>C:\ercoleAgent\config.json</code> (Windows).
The configuration properties are:</p> <ul><li><code>Hostname</code>: If the value is <code>default</code>, the hostname used to identifying the agents is the hostname of the host, otherwise it's the value of the <code>Hostname</code> property. The default value is <code>default</code>.</li> <li><code>Environment</code>: It's the environment of the machine. e.g TST, PRD, DEV, COLL, ...</li> <li><code>Location</code>: It's the physical location of the host. e.g Italy, Germany, France, ...</li> <li><code>DataserviceURL</code>: It's the base URL of ercole-dataservice to which are sent the hostdatas.</li> <li><code>AgentUser</code>: It's the username used by agent to be authenticated by ercole-dataservice.</li> <li><code>AgentPassword</code>: It's the password used by agent to be authenticated by ercole-dataservice.</li> <li><code>EnableServerValidation</code>: True if ercole-agent should validate ercole-dataservice https certificate.</li> <li><code>ForcePwshVersion</code>: Use a specific version of powershell. Used only on windows.</li> <li><code>Period</code>: Is the number of hour between different runs.</li> <li><code>Verbose</code>: Add more verbosity to agent .</li> <li><code>ParallelizeRequests</code>: True if ercole-agent should run the fetchers in parallel. Otherwise false.</li> <li><code>Features</code>: Contains specific configuration of the targets/features.</li></ul> <h3 id="virtualization-target"><a href="#virtualization-target" aria-hidden="true" class="header-anchor">#</a> Virtualization target</h3> <h4 id="requirements-4"><a href="#requirements-4" aria-hidden="true" class="header-anchor">#</a> Requirements</h4> <h5 id="vmware-vmware"><a href="#vmware-vmware" aria-hidden="true" class="header-anchor">#</a> VMWare/VMWare:</h5> <ul><li>PowerShell(pwsh) version &gt;= 2</li> <li><a href="https://thesysadminchannel.com/install-vmware-powercli-module-powershell/" target="_blank" rel="noopener noreferrer">VSphere power CLI module<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Access to vSphere via the 443 port</li> <li>Read only user access to vSphere</li> <li>PowerCLI is configured with the following command. <code>Set-PowerCLIConfiguration -Scope User -ParticipateInCEIP $false -InvalidCertificateAction ignore</code></li></ul> <h5 id="oracle-vm"><a href="#oracle-vm" aria-hidden="true" class="header-anchor">#</a> Oracle/VM</h5> <ul><li><code>ovm_vmcontrol</code> installed on the ovm manager</li> <li>Key exchange with ovm manager user who can run <code>ovm_vmcontrol</code></li> <li>VMs names must not contain spaces (they will be ignored)</li> <li><code>sshpass</code> is installed</li> <li><code>ovmcli</code> installed on ovmmanager (From version 3.2.1)</li> <li>Access ovmmanager via 10000 port</li></ul> <h4 id="configuration-features-virtualization"><a href="#configuration-features-virtualization" aria-hidden="true" class="header-anchor">#</a> Configuration (Features.Virtualization.*)</h4> <ul><li><code>Features.Virtualization.Enabled</code>: true if Virtualization support should be enabled.</li> <li><code>Features.Virtualization.FetcherUser</code>: name of the user that should be used for fetching the informations. If the value is empty, it's the user that is running the agent.</li> <li><code>Features.Virtualization.Hypervisors</code>: list of the hypervisors from which the clusters/vms list is fetched.</li> <li><code>Features.Virtualization.Hypervisors.Type</code>: contains the type of the hypervisors. Valid values are <code>vmware</code>, <code>ovm</code>.</li> <li><code>Features.Virtualization.Hypervisors.Endpoint</code>: contains the endpoint of the hypervisor, e.g vSphere or ovmmanager ip address.</li> <li><code>Features.Virtualization.Hypervisors.Username</code>: contains the username used to authenticate the agent.</li> <li><code>Features.Virtualization.Hypervisors.OvmUserKey</code>: it's the user ID of the user on ovmmanger that have exchanged keys with the components.</li> <li><code>Features.Virtualization.Hypervisors.OvmControl</code>: contains the /path/to/ovmcontrol.</li></ul> <h3 id="oracle-database-target"><a href="#oracle-database-target" aria-hidden="true" class="header-anchor">#</a> Oracle/Database target</h3> <h4 id="requirements-5"><a href="#requirements-5" aria-hidden="true" class="header-anchor">#</a> Requirements</h4> <ul><li>Oracle Database version &gt;= 9i</li></ul> <h4 id="configuration-features-oracledatabase"><a href="#configuration-features-oracledatabase" aria-hidden="true" class="header-anchor">#</a> Configuration (Features.OracleDatabase.*)</h4> <ul><li><code>Features.OracleDatabase.Enabled</code>: true if Oracle/Database support should be enabled.</li> <li><code>Features.OracleDatabase.FetcherUser</code>: name of the user that should be used for fetching the informations. If the value is empty, it's the user that is running the agent.</li> <li><code>Features.OracleDatabase.Oratab</code>: it's the /path/to/the/oratab, the file that contains the list of DBs</li> <li><code>Features.OracleDatabase.AWR</code>: it's the number of Automatic workload repository</li> <li><code>Features.OracleDatabase.Forcestats</code>: true if enable the running of fetch/stats fetcher</li></ul> <h3 id="oracle-exadata-target"><a href="#oracle-exadata-target" aria-hidden="true" class="header-anchor">#</a> Oracle/Exadata target</h3> <h4 id="requirements-6"><a href="#requirements-6" aria-hidden="true" class="header-anchor">#</a> Requirements</h4> <p>The exadata component should not be virtualized.</p> <h4 id="configuration-features-oracleexadata"><a href="#configuration-features-oracleexadata" aria-hidden="true" class="header-anchor">#</a> Configuration (Features.OracleExadata.*)</h4> <ul><li><code>Features.OracleExadata.Enabled</code>: true if Oracle/Exadata support should be enabled.</li> <li><code>Features.OracleExadata.FetcherUser</code>: name of the user that should be used for fetching the informations. If the value is empty, it's the user that is running the agent. Root permissions are usually required.</li></ul> <h3 id="microsoft-sqlserver-target"><a href="#microsoft-sqlserver-target" aria-hidden="true" class="header-anchor">#</a> Microsoft/SQLServer target</h3> <h4 id="requirements-7"><a href="#requirements-7" aria-hidden="true" class="header-anchor">#</a> Requirements</h4> <ul><li>The service user need administration permissions to access to the instances (Trusted connection)</li> <li>TCP/IP protocol connections is enabled on the instances</li> <li>ercole-agent service need to have a setted user</li></ul> <h4 id="configuration-features-microsoftsqlserver"><a href="#configuration-features-microsoftsqlserver" aria-hidden="true" class="header-anchor">#</a> Configuration (Features.MicrosoftSQLServer.*)</h4> <ul><li><code>Features.MicrosoftSQLServer.Enabled</code>: true if Microsoft/SQLServer support should be enabled.</li> <li><code>Features.MicrosoftSQLServer.FetcherUser</code>: name of the user that should be used for fetching the informations. If the value is empty, it's the user that is running the agent. It's useless...</li></ul> <h2 id="ercole-agent-perl"><a href="#ercole-agent-perl" aria-hidden="true" class="header-anchor">#</a> Ercole-agent-perl</h2> <h4 id="requirements-8"><a href="#requirements-8" aria-hidden="true" class="header-anchor">#</a> Requirements</h4> <ul><li>perl &gt;= 5.8.8</li> <li>Oracle Database version &gt;= 9i</li></ul> <h3 id="solaris-installation"><a href="#solaris-installation" aria-hidden="true" class="header-anchor">#</a> Solaris installation</h3> <ol><li>Download the agent from the repository</li> <li><code>cd /</code></li> <li><code>tar xvf /path/to/ercole-agent-perl-&lt;version&gt;-1.solaris11.noarch.tar.gz</code></li> <li><code>svcadm restart manifest-import</code></li> <li><code>svcadm enable ercole-agent-perl</code></li></ol> <h4 id="maintenance"><a href="#maintenance" aria-hidden="true" class="header-anchor">#</a> Maintenance</h4> <ul><li>The service can be restarted with <code>svcadm restart ercole-agent-perl</code>.</li> <li>The log can be usually found in <code>/var/svc/log/ercole-agent-perl:default.log</code>.</li> <li>The state can be queried with <code>svcs -x ercole-agent-perl</code></li></ul> <h3 id="aix-installation"><a href="#aix-installation" aria-hidden="true" class="header-anchor">#</a> AIX installation</h3> <ol><li>Download the agent from the repository</li> <li><code>useradd -g dba -d /home/ercole-agent -m -s /bin/bash -c &quot;Ercole agent user&quot; ercole</code></li> <li><code>touch /var/log/ercole-agent-perl.log</code></li> <li><code>chown ercole /var/log/ercole-agent-perl.log</code></li> <li><code>rpm -ivh ercole-agent-perl-&lt;version&gt;-1.aix6.1.noarch.rpm</code></li> <li><code>/etc/rc.d/init.d/ercole-agent-perl start</code></li></ol> <h4 id="maintenance-2"><a href="#maintenance-2" aria-hidden="true" class="header-anchor">#</a> Maintenance</h4> <ul><li>The service can be restarted with <code>/etc/rc.d/init.d/ercole-agent-perl restart</code>.</li> <li>The log can be usually found in <code>/var/log/ercole-agent.log</code>.</li> <li>The state can be queried with <code>ps -ef | grep ercole-agent</code></li></ul> <h3 id="hpux-installation"><a href="#hpux-installation" aria-hidden="true" class="header-anchor">#</a> HPUX installation</h3> <ol><li>Download the agent from the repository</li> <li><code>cd /</code></li> <li><code>tar xvf /path/to/ercole-agent-perl-&lt;version&gt;-1.hpux.noarch.tar.gz</code></li> <li><code>useradd -g dba -d /home/ercole-agent -m -s /bin/bash -c &quot;Ercole agent user&quot; ercole</code></li> <li><code>touch /var/adm/ercole-agent.log</code></li> <li><code>chown ercole /var/adm/ercole-agent.log</code></li> <li><code>/sbin/init.d/ercole-agent start</code></li></ol> <h4 id="maintenance-3"><a href="#maintenance-3" aria-hidden="true" class="header-anchor">#</a> Maintenance</h4> <ul><li>The service can be restarted with <code>/sbin/init.d/ercole-agent restart</code>.</li> <li>The log can be found in <code>/var/adm/ercole-agent.log</code>.</li> <li>The state can be queried with <code>ps -ef | grep ercole-agent</code></li></ul> <h3 id="configuration-3"><a href="#configuration-3" aria-hidden="true" class="header-anchor">#</a> Configuration</h3> <p>Ercole-agent-perl can be configured modifying the content of the <code>config.json</code> stored in <code>/opt/ercole-agent/config.json</code> (Linux).
The configuration properties are:</p> <ul><li><code>hostname</code>: If the value is <code>default</code>, the hostname used to identifying the agents is the hostname of the host, otherwise it's the value of the <code>Hostname</code> property. The default value is <code>default</code>.</li> <li><code>envtype</code>: It's the environment of the machine. e.g TST, PRD, DEV, COLL, ...</li> <li><code>location</code>: It's the physical location of the host. e.g Italy, Germany, France, ...</li> <li><code>serverurl</code>: It's the base URL of ercole-dataservice to which are sent the hostdatas.</li> <li><code>serverusr</code>: It's the username used by agent to be authenticated by ercole-dataservice.</li> <li><code>serverpsw</code>: It's the password used by agent to be authenticated by ercole-dataservice.</li> <li><code>frequency</code>: Is the number of hour between different runs.</li> <li><code>forcestats</code>: True if the fetcher fetch/*/stats should be run</li> <li><code>EnableServerValidation</code>: True if ercole-agent should validate ercole-dataservice https certificate.</li> <li><code>oratab</code>: it's the /path/to/the/oratab, the file that contains the list of DBs</li> <li><code>AWR</code>: it's the number of Automatic workload repository</li> <li><code>UseCurl</code>: true if the agent should use curl to send the hostdata. Otherwise use the internal perl library. On solaris the internal library seems to not work.</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        
        <a href="/introduction.html" class="prev">
          Introduction
        </a></span> <span class="next"><a href="/guide-1.x.html">
          Getting Started Ercole 1.x
        </a>
        
      </span></p></div> </main></div> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.21561b35.js" defer></script><script src="/assets/js/6.f4499a36.js" defer></script><script src="/assets/js/3.6e75f971.js" defer></script><script src="/assets/js/11.250c2092.js" defer></script>
  </body>
</html>
